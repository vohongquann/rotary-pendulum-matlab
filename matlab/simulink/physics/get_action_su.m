function action = get_action_su(obs)
%#codegen
obs = reshape(obs, [6,1]);
persistent W1 b1 W2 b2 W3 b3 W4 b4
if isempty(W1)
  W1 = [
    -0.3604874313  0.2446603328  0.3908882737  0.1170430183 -0.0000000000  0.3923386037;
     0.4723031521  0.1143659130 -0.7781905532  0.1058465838 -0.0000000000  0.1804689765;
     0.3439880610 -0.1050546840 -0.1920727938 -0.0642580986  0.0000000000  0.4568383694;
     0.4494181871 -0.2851548195 -0.2382684648 -0.3857304752  0.0000000000  0.4512959719;
     0.3095746934 -0.3136585355  0.2708377540 -0.2687170804 -0.0000000000  0.3916043937;
    -0.2922243774 -0.1376840174 -0.5126000643 -0.1459700465 -0.0000000000  0.2261624038;
    -0.2335021198  0.1653338373 -0.7921445370 -0.0147853838 -0.0000000000  0.3932779729;
    -0.8810408115 -0.2916781306 -0.0684812292 -0.1395644248  0.0000000000 -0.8413730860;
  ];
  b1 = [
     0.1047884077;
     0.0755631253;
     0.1840701550;
    -0.1547516286;
    -0.1269310415;
    -0.0538193211;
    -0.1262226105;
    -0.7686458230;
  ];
  W2 = [
     0.0000000000  0.0000000000 -0.0000000152  0.0000000000  0.0000000000  0.0000000000 -0.0000000000 -0.0000000000;
    -0.0859988183  0.1526038349  0.2308953702  0.1911740899 -0.1033176705  0.0880465433 -0.0620049015 -1.0561980009;
    -0.0190120395  0.0204170402 -0.4781188965  0.0348308347  0.0250783749  0.2291251272 -0.1727685332 -0.0320408233;
    -0.0000000000  0.0000000000 -0.0000000000 -0.0000000000 -0.0000000000 -0.0000000000  0.0000000000  0.0000000000;
     0.0449884720 -0.0474860668  0.1903801262 -0.0532008260  0.0136563545  0.0947386026  0.0527947061 -1.4842731953;
    -0.4505098760 -0.6065511107 -0.0752704144  0.4016541541 -0.5254154801  0.0726644620  0.3330216706  0.0000365384;
     0.2688514292 -0.2994299233  0.2549334168 -0.0416513123  0.2510111928  0.6498180032  0.2491117269  0.4290494919;
    -0.2458523363 -0.0066560456 -0.0114567159 -0.2577047050  0.3396142125 -0.4745740294  0.1557659209  0.0000000026;
  ];
  b2 = [
     0.0000000000;
    -0.0106796268;
    -0.1518827826;
     0.0000000000;
     0.4734317362;
    -0.1257738173;
    -0.0670210198;
    -0.0818942711;
  ];
  W3 = [
     0.0000000000 -0.6462572217 -0.4688753188 -0.0000000903 -0.4778611958 -0.2411210984  0.4335078299 -0.5567780137;
  ];
  b3 = [
     0.1575460136;
  ];
  W4 = [
    -0.0000000000 -0.2234653234 -0.1904230118  0.0000000000  0.8129577637  0.0077642300 -0.0033917907 -0.3067452013;
  ];
  b4 = [
    -0.2855005562;
  ];
end
x = obs;
x = W1 * x + b1;
x = relu(x);
x = W2 * x + b2;
x = relu(x);
mean = W3 * x + b3;
logStd = W4 * x + b4;
std = softplus(logStd);
epsilon = zeros(size(std));
preAct = mean + std .* epsilon;
action = tanh(preAct);
end

function y = relu(x)
y = max(0, x);
end

function y = softplus(x)
y = log(1 + exp(x));
end

function y = tanh(x)
y = (exp(x) - exp(-x)) ./ (exp(x) + exp(-x));
end